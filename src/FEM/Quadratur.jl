function QuadRule(type::Grids.QuadPrimal,n)
  NumQuad = n * n
  x, w = gaussradau(n)
  @. x = -x
  Weights = zeros(NumQuad)
  Points = zeros(NumQuad,2)
  ii = 1
  for j = 1 : n
    for i = 1 : n
      Weights[ii] = w[i] * w[j]
      Points[ii,1] = x[i]
      Points[ii,2] = x[j]
      ii += 1
    end
  end
  return NumQuad, Weights, Points
end


function QuadRule(type::Grids.QuadDual,n)
  NumQuad =  n * n  
  x, w = gaussradau(n)
  x .= -x
  Weights = zeros(NumQuad)
  Points = zeros(NumQuad,2)
  ii = 1
  for j = 1 : n
    for i = 1 : n
      Weights[ii] = w[n+1-i] * w[n+1-j]
      Points[ii,1] = x[i]
      Points[ii,2] = x[j]
      ii += 1
    end
  end
  return NumQuad, Weights, Points
end

function QuadRule(type::Grids.Line,n)
 x, w = gausslobatto(n+1)
# x, w = gausslegendre(n+1)
  NumQuad = (n+1)
  Weights = zeros(NumQuad)
  Points = zeros(NumQuad)
  ii = 1
  for i = 1 : n+1
    Weights[ii] = w[i]
    Points[ii,1]=x[i]
    ii += 1
  end
  return NumQuad, Weights, Points
end


function QuadRule(type::Grids.Quad,n)
  x, w = gausslobatto(n+1)
# x, w = gausslegendre(n+1)
    NumQuad = (n+1)*(n+1)
    Weights = zeros(NumQuad)
    Points = zeros(NumQuad,2)
    ii = 1
    for j = 1 : n + 1
        for i = 1 : n + 1
            Weights[ii] = w[i]*w[j]
            Points[ii,1]=x[i]
            Points[ii,2]=x[j] 
            ii += 1
        end    
    end
  return NumQuad, Weights, Points
end

#using ideas of Kubatko quadtriangle.m
#nonproduct quadrature rules for triangles
function QuadRule(type::Grids.Tri,Ord)

  if Ord == 1
    NumQuad =  1
    Points = [  -0.333333333333333  -0.333333333333333  ]   

    Weights= [  2.0 ]
  elseif Ord == 2
    NumQuad =  3
    Points = [  0.333333333333333  -0.666666666666667
                -0.666666666666667  -0.666666666666667
                -0.666666666666667   0.333333333333333  ]   

    Weights= [  0.666666666666667
                0.666666666666667
                0.666666666666667 ]
  elseif Ord == 3
    NumQuad =  6
    Points = [  0.0                 -1.000000000000000
                -1.000000000000000  0.0
                0.0                 0.0
                -0.666666666666667  0.333333333333333
                0.333333333333333   -0.666666666666667
                -0.666666666666667  -0.666666666666667  ]   

    Weights= [  0.066666666666667
                0.066666666666667
                0.066666666666667
                0.600000000000000
                0.600000000000000
                0.600000000000000 ] 
  elseif Ord == 4
    NumQuad =  6
    Points = [  -0.108103018168070  -0.783793963663859
                -0.783793963663859  -0.108103018168070
                -0.108103018168070  -0.108103018168070
                -0.816847572980459   0.633695145960917
                0.633695145960917  -0.816847572980459
                -0.816847572980459  -0.816847572980459  ]   

    Weights= [  0.446763179356023
                0.446763179356023
                0.446763179356023
                0.219903487310644
                0.219903487310644
                0.219903487310644 ] 
  elseif Ord == 5
    NumQuad =  7
    Points = [  -0.333333333333333  -0.333333333333333
                -0.797426985353087   0.594853970706175
                0.594853970706175  -0.797426985353087
                -0.797426985353087  -0.797426985353087
                -0.059715871789770  -0.880568256420460
                -0.880568256420460  -0.059715871789770
                -0.059715871789770  -0.059715871789770  ]   

    Weights= [  0.450000000000000
                0.251878361089654
                0.251878361089654
                0.251878361089654
                0.264788305577012
                0.264788305577012
                0.264788305577012 ]
  elseif Ord == 6
    NumQuad =  12
    Points = [  -0.873821971016996   0.747643942033991
                0.747643942033991  -0.873821971016996
                -0.873821971016995  -0.873821971016996
                -0.501426509658179   0.002853019316358
                0.002853019316358  -0.501426509658179
                -0.501426509658179  -0.501426509658179
                -0.379295097932431   0.273004998242797
                0.273004998242797  -0.893709900310366
                -0.893709900310366  -0.379295097932431
                0.273004998242797  -0.379295097932431
                -0.893709900310366   0.273004998242797
                -0.379295097932431  -0.893709900310366  ]   

    Weights= [  0.101689812740414
                0.101689812740414
                0.101689812740414
                0.233572551452759
                0.233572551452759
                0.233572551452759
                0.165702151236747
                0.165702151236747
                0.165702151236747
                0.165702151236747
                0.165702151236747
                0.165702151236747 ]
  elseif Ord == 7
    NumQuad =  15
    Points = [  -0.870138973681670   0.740277947363341
                0.740277947363341  -0.870138973681670
                -0.870138973681670  -0.870138973681670
                0.034079878138646  -0.430848831501659
                -0.430848831501659  -0.603231046636987
                -0.603231046636987   0.034079878138646
                -0.430848831501659   0.034079878138646
                -0.603231046636987  -0.430848831501659
                0.034079878138646  -0.603231046636987
                -0.912273056415255  -0.372881631230137
                -0.372881631230137   0.285154687645392
                0.285154687645392  -0.912273056415255
                -0.372881631230137  -0.912273056415255
                0.285154687645392  -0.372881631230137
                -0.912273056415255   0.285154687645392  ]   

    Weights= [  0.106155603580465
                0.106155603580465
                0.106155603580465
                0.141706167384267
                0.141706167384267
                0.141706167384267
                0.141706167384267
                0.141706167384267
                0.141706167384267
                0.138549364158834
                0.138549364158834
                0.138549364158834
                0.138549364158834
                0.138549364158834
                0.138549364158834   ]   
  end

  return NumQuad, Weights, Points
end
