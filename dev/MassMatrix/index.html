<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mass Matrix · CGDycore.jl</title><meta name="title" content="Mass Matrix · CGDycore.jl"/><meta property="og:title" content="Mass Matrix · CGDycore.jl"/><meta property="twitter:title" content="Mass Matrix · CGDycore.jl"/><meta name="description" content="Documentation for CGDycore.jl."/><meta property="og:description" content="Documentation for CGDycore.jl."/><meta property="twitter:description" content="Documentation for CGDycore.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CGDycore.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Mass Matrix</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Mass Matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mass Matrix</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/CGDycore.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/CGDycore.jl/blob/main/docs/src/MassMatrix.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Massmatrix"><a class="docs-heading-anchor" href="#Massmatrix">Massmatrix</a><a id="Massmatrix-1"></a><a class="docs-heading-anchor-permalink" href="#Massmatrix" title="Permalink"></a></h1><p><em>The mass matrix</em> represents the inner product in the discretized function space.</p><ul><li>For efficiency, we avoid explicitly assembling the mass matrix and instead</li></ul><p>apply its action directly to fields.</p><ul><li>In Julia, this is often achieved using <strong>matrix-free</strong> methods and</li></ul><p>broadcasting, enabling efficient and flexible computations.</p><p>The mass matrix acts as a &quot;pseudo-operator&quot;: it cannot be called directly, but can be applied to fields in a manner similar to other operators, leveraging broadcasting for performance and composability.</p><h3 id="General-Usage"><a class="docs-heading-anchor" href="#General-Usage">General Usage</a><a id="General-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#General-Usage" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CGDycore.FEMSei.MassMatrix" href="#CGDycore.FEMSei.MassMatrix"><code>CGDycore.FEMSei.MassMatrix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>MassMatrix H(curl) elements</p><p>Assembles the global mass matrix for a finite element discretization using H(curl) elements.</p><p><strong>Arguments</strong></p><ul><li><code>backend</code>: Computational backend to use (e.g., CPU, GPU).</li><li><code>FTB</code>: Finite element basis or transformation object.</li><li><code>Fe::HCurlElement</code>: The finite element object containing basis functions and related data for H(curl) elements.</li><li><code>Grid</code>: The computational grid or mesh structure containing faces and geometry information.</li><li><code>QuadOrd</code>: The order of the quadrature rule to use for numerical integration.</li><li><code>Jacobi</code>: Function that computes the Jacobian, its determinant, and pseudo-inverse for mapping reference to physical elements.</li></ul><p><strong>Returns</strong></p><ul><li><code>M</code>: The assembled sparse global mass matrix as a <code>SparseMatrixCSC</code>.</li></ul><p><strong>Description</strong></p><p>For each face in the grid, the function computes the local mass matrix by integrating the inner product of the mapped basis functions over the reference element using a specified quadrature rule. The local contributions are then assembled into the global sparse mass matrix. Only non-negligible entries (greater than <code>1.e-6</code> in magnitude) are included in the global matrix.</p><p><strong>Notes</strong></p><ul><li>The function assumes that the basis functions and their mapping are provided in the <code>Fe</code> object.</li><li>The Jacobian and its pseudo-inverse are used to map basis functions from the reference to the physical element.</li><li>The function is tailored for H(curl) elements and may require adaptation for other element types.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CGDycore.jl/blob/eb2a1ea2020c23276b7aac5c31660e88a4dbc95a/src/FEMSei/MassMatrix.jl#L1-L24">source</a></section><section><div><p>MassMatrix Scalar elements</p><p>Assembles the global mass matrix for a finite element mesh.</p><p><strong>Arguments</strong></p><ul><li><code>backend</code>: Computational backend to use (e.g., CPU, GPU).</li><li><code>FTB</code>: Finite element type or basis information.</li><li><code>Fe::ScalarElement</code>: Scalar finite element object containing basis functions and related data.</li><li><code>Grid</code>: Grid or mesh structure containing information about faces and connectivity.</li><li><code>QuadOrd</code>: Quadrature order for numerical integration.</li><li><code>Jacobi</code>: Function to compute the Jacobian, its determinant, and its pseudo-inverse for mapping reference to physical elements.</li></ul><p><strong>Returns</strong></p><ul><li><code>M</code>: Sparse matrix representing the assembled global mass matrix.</li></ul><p><strong>Description</strong></p><p>This function computes the mass matrix by looping over all faces in the mesh, evaluating basis functions at quadrature points, and assembling local contributions into the global sparse matrix. The Jacobian is used to map reference element integrals to the physical domain. Only nonzero entries are stored in the sparse matrix.</p><p><strong>Notes</strong></p><ul><li>The function assumes that <code>Fe.phi</code> contains callable basis functions.</li><li>The global degree of freedom mapping is provided by <code>Fe.Glob</code>.</li><li>The quadrature rule is determined by <code>FEMSei.QuadRule</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CGDycore.jl/blob/eb2a1ea2020c23276b7aac5c31660e88a4dbc95a/src/FEMSei/MassMatrix.jl#L140-L163">source</a></section><section><div><p>MassMatrix Scalar elements with weights</p><p>Assembles the mass matrix for a finite element method (FEM) problem using the provided scalar elements, quadrature order, and grid information.</p><p><strong>Arguments</strong></p><ul><li><code>backend</code>: Computational backend to use (e.g., CPU, GPU).</li><li><code>FTB</code>: Finite element basis or related data structure.</li><li><code>Fe::ScalarElement</code>: Finite element object representing the trial space.</li><li><code>w</code>: Vector of weights or coefficients for the weighted mass matrix.</li><li><code>wFe::ScalarElement</code>: Finite element object representing the weighting/test space.</li><li><code>Grid</code>: Grid or mesh data structure containing faces and connectivity.</li><li><code>QuadOrd</code>: Integer specifying the quadrature order for numerical integration.</li><li><code>Jacobi</code>: Function to compute the Jacobian, its determinant, and pseudo-inverse for mapping reference to physical elements.</li></ul><p><strong>Returns</strong></p><ul><li><code>M</code>: Sparse matrix representing the assembled mass matrix.</li></ul><p><strong>Description</strong></p><p>The function computes the local mass matrix for each face in the grid using numerical quadrature, basis functions, and the provided weights. It then assembles these local matrices into a global sparse mass matrix. The Jacobian is used to map quadrature points from the reference element to the physical element, and the determinant is used to scale the integration weights.</p><p><strong>Notes</strong></p><ul><li>The function assumes that the basis functions (<code>phi</code>) are provided as callable objects in <code>Fe</code> and <code>wFe</code>.</li><li>The global indices for assembling the sparse matrix are taken from <code>Fe.Glob</code> and <code>wFe.Glob</code>.</li><li>The function supports assembling weighted mass matrices by incorporating the vector <code>w</code> and its associated basis functions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CGDycore.jl/blob/eb2a1ea2020c23276b7aac5c31660e88a4dbc95a/src/FEMSei/MassMatrix.jl#L206-L231">source</a></section><section><div><p>MassMatrix Vector elements</p><p>Assembles the global mass matrix for a finite element discretization.</p><p><strong>Arguments</strong></p><ul><li><code>backend</code>: Computational backend to use (e.g., CPU, GPU).</li><li><code>FTB</code>: Finite element type or basis information.</li><li><code>Fe::VectorElement</code>: Finite element object containing basis functions, degrees of freedom, and global mapping.</li><li><code>Grid</code>: Grid or mesh structure containing face and connectivity information.</li><li><code>QuadOrd</code>: Quadrature order for numerical integration.</li><li><code>Jacobi</code>: Function to compute the Jacobian, its determinant, and pseudo-inverse for mapping reference to physical elements.</li></ul><p><strong>Returns</strong></p><ul><li><code>M</code>: Sparse matrix representing the assembled global mass matrix.</li></ul><p><strong>Description</strong></p><p>For each face in the grid, this function computes the local mass matrix using numerical quadrature and the provided basis functions. The local contributions are then assembled into the global sparse mass matrix using the global degree of freedom mapping.</p><p><strong>Notes</strong></p><ul><li>The function assumes 2D elements and vector-valued basis functions.</li><li>The quadrature rule and basis function evaluations are performed on the reference element and mapped to the physical element using the Jacobian.</li><li>Only nonzero entries are stored in the sparse matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CGDycore.jl/blob/eb2a1ea2020c23276b7aac5c31660e88a4dbc95a/src/FEMSei/MassMatrix.jl#L289-L312">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 2 August 2025 06:16">Saturday 2 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
